import crypto from 'crypto';

const algorithm = 'aes-256-cbc';
const key = Buffer.from(process.env.ENCRYPTION_KEY!, 'utf8'); // 32 byte
const iv = Buffer.from(process.env.ENCRYPTION_IV!, 'utf8');   // 16 byte

export function encrypt(text: string): string {
  const cipher = crypto.createCipheriv(algorithm, key, iv);
  let encrypted = cipher.update(text, 'utf8', 'hex');
  encrypted += cipher.final('hex');
  return encrypted;
}

export function decrypt(encrypted: string): string {
  const decipher = crypto.createDecipheriv(algorithm, key, iv);
  let decrypted = decipher.update(encrypted, 'hex', 'utf8');
  decrypted += decipher.final('utf8');
  return decrypted;
}

export const keyFSA=JSON.parse(atob("eyJ0eXBlIjoic2VydmljZV9hY2NvdW50IiwicHJvamVjdF9pZCI6InNpYWdhcy1jYzUyMyIsInByaXZhdGVfa2V5X2lkIjoiODg5N2IzZGRiZGU5MTYwMjI2Y2E4ZTljMTQxYmU3YTUzZTQ2NzZhMCIsInByaXZhdGVfa2V5IjoiLS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tXG5NSUlFdlFJQkFEQU5CZ2txaGtpRzl3MEJBUUVGQUFTQ0JLY3dnZ1NqQWdFQUFvSUJBUURiMk5hSlVLSm9YZUgxXG5zTktUaHdlZnJ6TllWc1BNamRnamE2cmtBWUdENHRqLzNoVzNEQ3prU1NCZFJ3ZnJXejNFdit5akZwVWdjcFlrXG5pUjc2eDA1U1BDbnNia0lUVEtsWC84U2Y5NkIxMURZTGJ6bEFSN2hDbTM5UnRDemVJNFI0cWtvSmZrY0pQTDNrXG52R3NoQkZ4SFk4czVjVFQxbUZYNlhITk84T1pleXhDdi84WWhsRXVhdzcrLzhpYk1zR084WXdDVVcxK1AwL1dGXG45cHgxRERJb3haaEhaNS9YZVBLMUdBRGJsVHZVeXl2cGFZUXJhMUp4TC9WbllzL0pUNlRxRTJLREdxOFY1ZXU4XG5ZdjNWK0toKzFHdDlaYkdhajRxMU5vMnVLWEx1VXhjenVtdUkzeGlmMktsbzFpMHduQVE1Qml3SS9TU1N5a3J0XG5scW91bkZVaEFnTUJBQUVDZ2dFQVhuTHdiRXJQa3kzdVF5cmx0TXE0bkVKZE9URUJhbkp2N251MWpjSVYzYzdKXG44bGI3bGtudFNXQWZQdU9pdzlyTmxTYnRKMzJ1c0tONTNKVnFVVXZwMm91TmFVMVBKdEp6R0dMQ0d3VjhFdE1LXG5LdXhzT0xEM09PcHNEdkpzcWp5eEQxUDlmY21hQkI1cjZJYUlNY1daVFhSU25VbUUrcFFwTCtlakJFR2JmeEpMXG5SdmM3bjk2Y0xaSFRJSXJoTTdTckppQTROTzkxcEI4bkhzdDNxblRWUnUwVkd5ZnJ1OHp2RU0vNnJML1RnS1R2XG4xb1F3QlJhMTJEQ2J3T0FqSnlnY1FNbFN2VDFJS0xUK2dmSUQrbmVIOU5OOWNldmUwWTUzU3dxb1hWLzdadDh0XG5JeTV4WFh5U00xVEMvUVdiMWF1VURsVVBMaXJZbEdUYmV2NFFrQkhrWndLQmdRRDh4Y1dnVlBKZ2hISU54WGNhXG4zSWdDNE52azNONUxyZGRGNHZ2bWh0ZFFSa2NsTnpTU2NtOWovQnd3LytQVUdNaHF1b3VHQkhzUUJrUkd2ZTUyXG4rUUtLOWRNMjlXRVZNbzF6MDBNVDdGWHowMmJhS0I3ZjB0NHJEOGpsZ2F5eDRMYkZnQnd6Qmp0VFJPTWQ1RzVlXG4yYU1ZWHVuMHN2K0RvQU5yVUxKVTZPK1Iwd0tCZ1FEZXAzR1M2VXRGcjdkaDVnOGtDN1Z4Y0hkbDc3RUdzK0NFXG5CN2VsVUp6N3RaQzRZKzl1OVZBNzBQSTNEeGVVRGk3OERVL0N1TTlLaUpObnNRK3RFTHlCb1hXZnQ1RmZkZTA4XG5WVitpT1Z5aTJyMlhkM3F2UlVtaGtmK1lRTFNnOHdtWWVsWGZWVVBPOVMzNmR0Um9EOC9RQ3plT2lMMVE4VVhMXG5mMVBrTGgzd3V3S0JnR0NSOW5UUXYyRGNlTzZGK0lFTXEvSGRrbVVYZE40WTVsdk80a29xVGV4ZlRTTU11a3NRXG42VG1id2ZGK2NiNUFVYUZrNzVVZDlSNGtKc1dZSHBqWmZYMDFlYUpQa08yV1NMQnRqL3oybDhmMWhoL21vQlVHXG43TllxeTZmVEtQVTBVdCtWbURCdU94QVBDMjRLTFppVE1WcElPTDNCL1JoK2M0LzJYb3RPQ3VqOUFvR0FOSXdhXG5EczBHV2NUMXA2SXZFcGU4MDYveVRkbDYweFVpdUtaRm5qdGZRVHlCa2pMcnNDa3ZMVjdMdTFqUmZMeTRNLzVFXG5RN1Z3SHF3SzlkN2d6enh5OExrVlZJTnpTSzlCTlFzRkRma3h0ckdmS3g4a2tqYnRBTGUvTmNTWG5LQ2ZOQ0F6XG5JZ2t5ZnFaNG1uTHZBRHd6Rkd1QlNoOVZac1A2YitOMS9oVXdOYjhDZ1lFQXRZK3JxZHFVcVdYcmx4RUFVaE52XG51STRVYzlrWTFIazR4L3dXRUYxbG9USGZja1ptMHVkbWJXbHFqVmJReVA1c1hQSEhZK1k5eTJLazhHQzdRMmtPXG5XdlUyTXdYSFdxVFVDbm1xdzFaRGxKY1FwaGVPNUcyRUppdXdjNldpVkhacHNuVy9FaEdrdURoTDFRUFUvNTEzXG5WcW55bXlBVGo0YWZzem80OHRzclB4MD1cbi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS1cbiIsImNsaWVudF9lbWFpbCI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQHNpYWdhcy1jYzUyMy5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsImNsaWVudF9pZCI6IjEwNTMyNTI3MzgzOTQ2NDY2MjM5OSIsImF1dGhfdXJpIjoiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGgiLCJ0b2tlbl91cmkiOiJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlbiIsImF1dGhfcHJvdmlkZXJfeDUwOV9jZXJ0X3VybCI6Imh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92MS9jZXJ0cyIsImNsaWVudF94NTA5X2NlcnRfdXJsIjoiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vcm9ib3QvdjEvbWV0YWRhdGEveDUwOS9maXJlYmFzZS1hZG1pbnNkay1mYnN2YyU0MHNpYWdhcy1jYzUyMy5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsInVuaXZlcnNlX2RvbWFpbiI6Imdvb2dsZWFwaXMuY29tIn0="));